---
name: QMS-Nexus-Architect
description: "强制执行 QMS-Nexus 项目的架构解耦规范、代码风格及 100% 单元测试覆盖率标准。在进行模块设计、逻辑编写及测试生成时触发。"
---

# QMS-Nexus 开发与测试规范

## 1. 架构解耦规范 (Architecture Rules)
- **严禁硬编码**：代码中严禁出现特定行业关键词（如 "质量", "ISO"）。所有业务语义必须通过 `config.yaml` 和系统提示词模板实现。
- **提示词管理**：必须使用 Jinja2 模板渲染 `system_prompts/` 下的文本文件。
- **模块化**：严格遵守目录结构。核心逻辑在 `core/`，解析在 `parsers/`，接口在 `api/`。UI 与逻辑必须分离。
- **配置驱动**：所有可变参数必须收拢于 `config/settings.py`。

## 2. 单元测试要求 (Testing Standards)
- **覆盖率**：`core/` 目录下核心逻辑的单元测试覆盖率必须达到 100%。
- **Mock 规范**：严禁真实调用外部 API（OpenAI 等）和真实磁盘 I/O。必须对 LLM 客户端、向量数据库、第三方解析库进行完整 Mock。
- **异步支持**：必须使用 `pytest-asyncio` 处理异步函数。
- **自动化**：每次生成新功能代码时，必须同步生成对应的测试代码。

## 3. 代码风格 (Coding Style)
- **类型提示**：所有函数必须包含 Python Type Hints。
- **防御性编程**：必须包含完善的异常捕获（try-except）和友好的错误提示。
- **异步优先**：I/O 密集型操作（API 调用、数据库读写）必须使用 async/await。

## 4. 验收标准
- 只有通过所有单元测试的代码才被视为“完成”。
- 答案输出必须包含来源标注，格式：`[来源：文件名, 第X页]`。