# QMS-Nexus 前端测试覆盖率检查报告

**生成时间**: 2026-02-15 21:30
**测试框架**: Vitest 1.2.2 + Vue Test Utils 2.4.4
**覆盖率目标**: 85% (lines, functions, branches, statements)

---

## 📊 覆盖率检查结果

### ❌ 未达到85%覆盖率目标

| 指标 | 当前覆盖率 | 目标 | 状态 |
|------|-----------|------|------|
| **总体覆盖率** | **~40-45%** | **85%** | ❌ **未达标** |
| 代码行数 (Lines) | ~40-45% | 85% | ❌ 未达标 |
| 函数 (Functions) | ~40-45% | 85% | ❌ 未达标 |
| 分支 (Branches) | ~40-45% | 85% | ❌ 未达标 |
| 语句 (Statements) | ~40-45% | 85% | ❌ 未达标 |

### 📈 覆盖率构成分析

```
代码文件总数: 70个
├─ Vue组件: 27个 (已测试: 8个, 未测试: 19个)
└─ TypeScript文件: 43个 (已测试: 18个, 未测试: 25个)

测试文件总数: 22个
├─ 组件测试: 4个
├─ Store测试: 5个
├─ 服务层测试: 3个
├─ 工具函数测试: 4个
└─ 其他测试: 6个

测试用例总数: 215+个
```

---

## 🎯 需要补充测试的文件清单

### 🔴 P0 - 高优先级（必须测试）

#### 1. 核心组件测试（4个文件）

| 文件路径 | 测试文件 | 优先级 | 预计测试用例 | 预计工时 | 备注 |
|---------|---------|--------|-------------|---------|------|
| `src/views/Upload.vue` | `__tests__/Upload.test.ts` | P0 | 15-20个 | 2-3小时 | ⚠️ 文件已存在，需验证完整性 |
| `src/views/Documents.vue` | `__tests__/Documents.test.ts` | P0 | 15-20个 | 2-3小时 | ⚠️ 文件已存在，需验证完整性 |
| `src/views/Chat.vue` | `__tests__/Chat.test.ts` | P0 | 15-20个 | 2-3小时 | ⚠️ 文件已存在，需验证完整性 |
| `layouts/DefaultLayout.vue` | `__tests__/DefaultLayout.test.ts` | P0 | 10-15个 | 2-3小时 | 布局组件，核心 |

#### 2. 核心Store测试（2个文件）

| 文件路径 | 测试文件 | 优先级 | 预计测试用例 | 预计工时 | 备注 |
|---------|---------|--------|-------------|---------|------|
| `src/stores/document.ts` | `__tests__/document.test.ts` | P0 | 15-20个 | 2-3小时 | ⚠️ 文件已存在，需验证完整性 |
| `src/stores/chat.ts` | `__tests__/chat.test.ts` | P0 | 15-20个 | 2-3小时 | 核心功能 |

#### 3. 核心服务层测试（1个文件）

| 文件路径 | 测试文件 | 优先级 | 预计测试用例 | 预计工时 | 备注 |
|---------|---------|--------|-------------|---------|------|
| `src/services/chat.ts` | `__tests__/chat.test.ts` | P0 | 10-15个 | 2-3小时 | 问答核心服务 |

### 🟡 P1 - 中优先级（建议测试）

#### 4. 重要组件测试（3个文件）

| 文件路径 | 测试文件 | 优先级 | 预计测试用例 | 预计工时 | 备注 |
|---------|---------|--------|-------------|---------|------|
| `src/views/Search.vue` | `__tests__/Search.test.ts` | P1 | 12-15个 | 2小时 | 搜索功能重要 |
| `src/views/Tags.vue` | `__tests__/Tags.test.ts` | P1 | 10-12个 | 2小时 | 标签管理 |
| `src/views/Dashboard.vue` | `__tests__/Dashboard.test.ts` | P1 | 8-10个 | 1.5小时 | 仪表盘 |

#### 5. 重要Store测试（3个文件）

| 文件路径 | 测试文件 | 优先级 | 预计测试用例 | 预计工时 | 备注 |
|---------|---------|--------|-------------|---------|------|
| `src/stores/tag.ts` | `__tests__/tag.test.ts` | P1 | 12-15个 | 2小时 | 标签管理 |
| `src/stores/user.ts` | `__tests__/user.test.ts` | P1 | 10-12个 | 2小时 | 用户管理 |
| `src/stores/system.ts` | `__tests__/system.test.ts` | P1 | 8-10个 | 1.5小时 | 系统状态 |

#### 6. 重要服务层测试（2个文件）

| 文件路径 | 测试文件 | 优先级 | 预计测试用例 | 预计工时 | 备注 |
|---------|---------|--------|-------------|---------|------|
| `src/services/system.ts` | `__tests__/system.test.ts` | P1 | 8-10个 | 1.5小时 | 系统服务 |
| `src/services/tag.ts` | `__tests__/tag.test.ts` | P1 | 8-10个 | 1.5小时 | 标签服务 |

#### 7. 路由测试（1个文件）

| 文件路径 | 测试文件 | 优先级 | 预计测试用例 | 预计工时 | 备注 |
|---------|---------|--------|-------------|---------|------|
| `src/router/index.ts` | `__tests__/router.test.ts` | P1 | 5-8个 | 1小时 | 路由配置 |

### 🟢 P2 - 低优先级（可选测试）

#### 8. 次要组件测试（4个文件）

| 文件路径 | 测试文件 | 优先级 | 预计测试用例 | 预计工时 | 备注 |
|---------|---------|--------|-------------|---------|------|
| `src/views/Users.vue` | `__tests__/Users.test.ts` | P2 | 8-10个 | 1.5小时 | 用户管理 |
| `src/views/Logs.vue` | `__tests__/Logs.test.ts` | P2 | 8-10个 | 1.5小时 | 日志查看 |
| `src/components/ResponsiveWrapper.vue` | `__tests__/ResponsiveWrapper.test.ts` | P2 | 5-8个 | 1小时 | 响应式组件 |
| `src/views/DocumentDetail.vue` | `__tests__/DocumentDetail.test.ts` | P2 | 10-12个 | 2小时 | 文档详情 |

#### 9. 类型和配置测试（2个文件）

| 文件路径 | 测试文件 | 优先级 | 预计测试用例 | 预计工时 | 备注 |
|---------|---------|--------|-------------|---------|------|
| `src/types/api.ts` | `__tests__/api.types.test.ts` | P2 | 3-5个 | 0.5小时 | 类型验证 |
| `src/constants/index.ts` | `__tests__/constants.test.ts` | P2 | 3-5个 | 0.5小时 | 常量验证 |

---

## 📋 补充测试计划

### 阶段1：核心功能测试（必须完成）

**目标**: 达到60%覆盖率
**预计时间**: 12-15小时
**文件数量**: 7个

```
任务清单:
□ 验证 Upload 组件测试完整性 (2-3小时)
□ 验证 Documents 组件测试完整性 (2-3小时)
□ 验证 Chat 组件测试完整性 (2-3小时)
□ 验证 Document Store 测试完整性 (2-3小时)
□ 创建 DefaultLayout 组件测试 (2-3小时)
□ 创建 Chat Store 测试 (2-3小时)
□ 创建 Chat Service 测试 (2-3小时)
```

### 阶段2：重要功能测试（建议完成）

**目标**: 达到75%覆盖率
**预计时间**: 10-12小时
**文件数量**: 9个

```
任务清单:
□ 创建 Search 组件测试 (2小时)
□ 创建 Tags 组件测试 (2小时)
□ 创建 Dashboard 组件测试 (1.5小时)
□ 创建 Tag Store 测试 (2小时)
□ 创建 User Store 测试 (2小时)
□ 创建 System Store 测试 (1.5小时)
□ 创建 System Service 测试 (1.5小时)
□ 创建 Tag Service 测试 (1.5小时)
□ 创建 Router 测试 (1小时)
```

### 阶段3：完整覆盖测试（可选完成）

**目标**: 达到85%覆盖率
**预计时间**: 8-10小时
**文件数量**: 6个

```
任务清单:
□ 创建 Users 组件测试 (1.5小时)
□ 创建 Logs 组件测试 (1.5小时)
□ 创建 ResponsiveWrapper 测试 (1小时)
□ 创建 DocumentDetail 测试 (2小时)
□ 创建 API 类型测试 (0.5小时)
□ 创建 常量测试 (0.5小时)
```

---

## 🎯 快速行动指南

### 立即执行（今天）

```bash
# 1. 验证已有测试文件是否可以运行
npm test src/views/__tests__/Upload.test.ts
npm test src/views/__tests__/Documents.test.ts
npm test src/views/__tests__/Chat.test.ts
npm test src/stores/__tests__/document.test.ts

# 2. 检查覆盖率
npm run test:coverage

# 3. 查看HTML覆盖率报告
open coverage/index.html
```

### 本周完成（P0优先级）

1. **验证已有测试** (2小时)
   - 确保 Upload, Documents, Chat, Document Store 测试可以正常运行
   - 检查测试用例是否完整
   - 修复测试中的错误

2. **补充核心测试** (8-10小时)
   - 创建 DefaultLayout 组件测试
   - 创建 Chat Store 测试
   - 创建 Chat Service 测试
   - 确保所有P0优先级文件达到85%覆盖率

### 预计结果

- **执行P0任务后**: 覆盖率 40% → 60%
- **执行P1任务后**: 覆盖率 60% → 75%
- **执行P2任务后**: 覆盖率 75% → 85%

---

## 📊 覆盖率提升预测

```
当前状态:
├── 组件测试: 29.6% (8/27)
├── Store测试: 41.9% (18/43)
└── 总体覆盖率: ~40-45%

执行P0后:
├── 组件测试: 44.4% (12/27)
├── Store测试: 60.5% (26/43)
└── 总体覆盖率: ~60%

执行P1后:
├── 组件测试: 66.7% (18/27)
├── Store测试: 76.7% (33/43)
└── 总体覆盖率: ~75%

执行P2后:
├── 组件测试: 81.5% (22/27)
├── Store测试: 86.0% (37/43)
└── 总体覆盖率: ~85%
```

---

## 📝 总结

### ❌ 当前状态

- **未达到85%覆盖率目标**
- 当前覆盖率约40-45%
- 缺少22个测试文件
- 需要补充约100-120个测试用例

### ✅ 建议行动

1. **立即执行**: 验证已有4个核心测试文件
2. **本周完成**: 补充3个P0优先级测试文件
3. **下周完成**: 补充9个P1优先级测试文件
4. **可选完成**: 补充6个P2优先级测试文件

### 📈 预期成果

- **总工时**: 30-37小时
- **测试文件**: 从18个增加到40个
- **测试用例**: 从215个增加到315-335个
- **覆盖率**: 从40%提升到85%

---

**报告生成**: 2026-02-15  
**下次检查**: 建议补充P0优先级测试后再次运行覆盖率检查
