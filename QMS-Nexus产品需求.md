
### 第一阶段：MVP（医疗器械质量管理体系，简称QMS-Nexus）

**[原始需求]**
*   **US-MVP-01：多格式文档上传与解析入库**
    *   场景：用户本地上传PDF（图片pdf、文字版本pdf）/Word（doc,docx）/Excel/PPT格式的质量体系文档（单文件≤50M）
    *   验收：无上传报错，文本/表格核心内容无丢失、无乱码，解析后自动存入ChromaDB向量库
*   **US-MVP-02：文档分块与元数据记录**
    *   场景：解析文档时自动进行文本分块，关联文档基础信息
    *   验收：分块大小适配QMS专业术语（无断句歧义），元数据（文件名、文件类型、页码/段落）随文本同步入库，可溯源
*   **US-MVP-03：基于文档的精准问答**
    *   场景：用户在web界面输入文档内相关问题（如“ISO13485 设计开发要求”）
    *   验收：回答贴合文档内容，无虚假信息，针对明确问题准确率≥90%，响应时间≤5秒
*   **US-MVP-04：回答来源精准标注**
    *   场景：用户提问后获取AI回答，需查看答案出处
    *   验收：回答末尾标注完整来源信息（文档名称+页码/PPT页数/Excel工作表名），来源匹配准确率100%
*   **US-MVP-05：web本地前端基础交互**
    *   场景：用户在Windows本地启动前端界面，完成“提问-看回答”全操作
    *   验收：界面无卡顿，按钮/输入框/上传组件功能正常，操作流程无跳转异常，启动时间≤1分钟
*   **US-MVP-06：基础错误处理**
    *   场景：用户上传非支持格式文件、空文件、超大小文件或输入无意义问题
    *   验收：前端弹出清晰错误提示（如“仅支持PDF/Word/Excel/PPT格式”），程序不崩溃、不闪退
*   **US-MVP-07：本地向量库基础管理**
    *   场景：用户需清空已入库的测试文档，重新上传新文档
    *   验收：提供“清空知识库”按钮，点击后向量库数据全部清除，无残留，重新上传可正常入库
*   **US-MVP-08：本地全流程联调稳定性**
    *   场景：用户连续完成“上传多份文档→多次提问→查看来源”全流程操作
    *   验收：连续操作≥10次无程序崩溃，检索/回答无数据冲突，本地运行无明显卡顿

**[新增/优化需求]**
*   **US-MVP-09：集成专业解析引擎 (MinerU/Unstructured)**
    *   场景：后台放弃手写正则，集成专业引擎解析复杂文档。
    *   验收：1. 调用 MinerU 或 Unstructured API/库进行解析；2. **Excel 自动转为 Markdown 格式**后再入库，确保表格逻辑关系不丢失。
*   **US-MVP-10：基于 Streamlit 的快速前端实现**
    *   场景：单人开发阶段，快速搭建 Web 交互界面。
    *   验收：使用 Streamlit 框架完成 US-MVP-05 的所有交互，支持侧边栏上传和主窗口对话。
*   **US-MVP-11：异步解析进度条与时间预估**
    *   场景：用户上传大文件后，后台进行耗时解析。
    *   验收：1. 前端实时展示进度条（0-100%）；2. 界面显示当前状态（如“正在转码MD...”）；3. 根据文件大小给出预估剩余时间。


**[MVP 阶段性能与硬件要求]**
*   **性能：** 单文件（50MB）上传至解析完成总耗时 **< 30s**。
*   **硬件：** 最低配置 4核CPU / 8G内存；若使用云端API，无需显卡。

---

### 第二阶段：Alpha（反馈闭环与API化版）- 内网推广/可迭代

**[原始需求]**
*   **US-Alpha-01：FastAPI接口封装（核心功能）**
    *   场景：通过Postman/内网调用接口，完成文档上传和问答
    *   验收：封装/upload（上传入库）、/query（提问回答）接口，返回JSON格式数据，接口响应时间≤3秒，可用率100%
*   **US-Alpha-02：用户反馈（赞/踩）功能**
    *   场景：内网用户在前端对AI回答进行“满意（赞）/不满意（踩）”评价
    *   验收：点击赞/踩按钮无报错，反馈结果实时存入SQLite，关联对应问题+回答ID，可溯源
*   **US-Alpha-03：人工修正答案提交**
    *   场景：用户对AI不满意回答，输入正确答案并提交
    *   验收：提供修正输入框，提交后**{问题+正确答案+原错误回答}** 同步存入SQLite人工修正库，字段完整无缺失
*   **US-Alpha-04：后台基础日志查看**
    *   场景：管理员在前端后台界面，查看内网用户的使用记录
    *   验收：可按时间查看提问日志（用户问题、提问时间）、回答日志（AI回答、来源）、反馈日志（赞/踩、修正答案），支持模糊检索
*   **US-Alpha-05：内网多用户同时使用**
    *   场景：≥20名内网用户同时登录界面，进行上传/提问操作
    *   验收：无账号冲突、无数据覆盖，接口调用无排队卡顿，各用户数据独立存储
*   **US-Alpha-06：修正库优先检索**
    *   场景：用户提问的问题已存在人工修正记录
    *   验收：RAG检索时优先调用人工修正库，直接返回正确答案，标注“人工修正答案”
*   **US-Alpha-07：接口基础鉴权（内网级）**
    *   场景：非内网IP/未授权用户尝试调用FastAPI接口
    *   验收：接口拒绝访问，返回403错误提示，仅内网指定IP可正常调用
*   **US-Alpha-08：内网部署一键启动**
    *   场景：管理员在公司内网服务器部署项目，启动服务
    *   验收：提供启动脚本，双击即可启动前端+后端，无需额外配置，启动后全公司可访问

**[新增/优化需求]**
*   **US-Alpha-09：高并发性能优化**
    *   场景：应对内网多用户同时访问。
    *   验收：**并发用户数 > 20** 时，系统响应稳定，不出现连接重置或 502 错误。
*   **US-Alpha-10：问答响应限时**
    *   场景：用户提问后需快速得到反馈。
    *   验收：在并发环境下，单个问题的**完整回答生成时间 < 10s**。

**[Alpha 阶段性能与硬件要求]**
*   **性能：** 并发数 ≥ 20；API 接口平均延迟 < 3s（不含模型生成时间）。
*   **硬件：** 推荐 8核CPU / 16G内存；若内网部署本地模型，需配备 12G 显存以上的显卡（如 RTX 3060/4060）。

---

### 第三阶段：Beta（商业化与部署版）- 可对外演示/私有化部署

**[原始需求]**
*   **US-Beta-01：API Key管理功能**
    *   场景：管理员在后台生成/禁用API Key，用于接口授权调用
    *   验收：支持生成多组独立API Key，可标记启用/禁用状态，接口调用需携带有效API Key，否则拒绝访问
*   **US-Beta-02：API调用次数统计**
    *   场景：授权客户使用API Key调用接口，管理员查看使用数据
    *   验收：按API Key统计日/周/总调用次数，数据实时更新，可导出Excel，为计费提供基础
*   **US-Beta-03：Docker容器化打包**
    *   场景：在任意兼容Docker的服务器/本地环境，部署QMS-Brain
    *   验收：生成完整Dockerfile和docker-compose.yml，执行docker-compose up即可启动，部署步骤≤3步，启动成功率100%
*   **US-Beta-04：绿色免安装环境交付**（*原EXE方案已修改*）
    *   场景：客户环境无 Python，且无法使用 Docker。
    *   验收：提供包含嵌入式 Python 环境的**绿色文件夹压缩包**，内置所有依赖库，用户解压后运行启动脚本即可使用，无需安装配置。
*   **US-Beta-05：本地大模型（Ollama）对接**
    *   场景：用户选择本地部署大模型（DeepSeek-7B/Qwen-7B），避免数据外发
    *   验收：可在前端切换“本地模型/云端API”，对接Ollama后全流程本地运行，问答/解析无外部网络请求，响应时间≤8秒
*   **US-Beta-06：敏感信息基础脱敏（可选）**
    *   场景：用户上传含企业名称/产品型号的敏感质量文档，提问时自动脱敏
    *   验收：可自定义脱敏关键词，AI回答中自动屏蔽敏感信息，仅保留专业内容，不影响问答准确性
*   **US-Beta-07：产品化界面优化**
    *   场景：对外演示时，用户操作前端界面
    *   验收：界面增加产品logo/使用引导/操作提示，无开发相关冗余按钮，非技术人员可快速上手，操作流程≤3步
*   **US-Beta-08：私有化部署数据隔离**
    *   场景：多客户私有化部署，或企业内部多部门使用
    *   验收：不同部署实例/部门的文档库/问答日志/修正库完全隔离，无数据交叉泄露，本地数据可一键备份/导出
*   **US-Beta-09：商业化演示基础适配**
    *   场景：对外给客户演示“上传行业规范→提问→看回答→查来源→反馈修正”全流程
    *   验收：演示流程无BUG、无卡顿，核心功能（私有化、行业适配、来源标注）展示清晰，满足客户体验需求
*   **US-Beta-10：一键备份/恢复知识库**
    *   场景：用户需备份本地向量库/人工修正库，或更换设备后恢复数据
    *   验收：提供“备份知识库”“恢复知识库”按钮，备份文件为压缩包，恢复后数据完整无丢失，可直接使用

**[新增/优化需求]**
*   **US-Beta-11：前端专业化重构 (Vue/React)**
    *   场景：商业化交付，提升界面性能与美观度。
    *   验收：弃用 Streamlit，使用 Vue3 或 React 重构前端，实现更流畅的 UI 交互和更灵活的布局（如左右分栏预览）。
*   **US-Beta-12：资源占用监控与限制**
    *   场景：在客户提供的有限资源服务器上运行。
    *   验收：支持在配置文件中设置最大内存占用上限，当资源达到临界值时，系统自动对解析任务进行排队处理。
*   **US-Beta-13：系统角色 (System Prompt) 自定义**
    *   场景：法律公司想让 AI 像律师一样说话，而 QMS 公司想让它像审核员。
    *   验收：法律公司想让 AI 像律师一样说话，而 QMS 公司想让它像审核员。
*   **US-Beta-15：多知识库分区 (Multi-Tenancy)**
    *   场景：客户希望把“人力资源”和“法律条款”分开，互不干扰。
    *   验收：1. 支持创建多个独立的知识库实例；2. 提问时可勾选“在哪个库中搜索”；3. 不同库的向量数据物理或逻辑隔离。
*   **US-Beta-16：自定义元数据标签**
    *   场景：法律文档需要“案号”，QMS文档需要“体系编号”。
    *   验收：1. 上传时支持自定义标签（Tag）；2. 检索结果展示这些自定义标签，不硬编码 QMS 专用字段。

**[Beta 阶段性能与硬件要求]**
*   **性能：** 
    *   支持私有化部署下的全流程离线运行。
    *   问答首字响应时间 < 2s。
*   **硬件：** 
    *   **标准版：** 8核CPU / 16G内存 / 无显卡（调用云端API）。
    *   **私有化版：** 8核CPU / 32G内存 / NVIDIA RTX 4060 (8G/12G) 或以上显卡。